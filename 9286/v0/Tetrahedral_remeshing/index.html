<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://doc.cgal.org/latest/Tetrahedral_remeshing/index.html"/>

<link rel="icon" type="image/png" href="../Manual/g-196x196-doc.png">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=11">
<meta name="generator" content="Doxygen 1.9.6">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CGAL 6.2 - Tetrahedral Remeshing: User Manual</title>
<!-- <link href="../Manual/tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="../Manual/jquery.js"></script>
<script type="text/javascript" src="../Manual/dynsections.js"></script>
<script src="../Manual/hacks.js" type="text/javascript"></script>
<!-- Manually include treeview and search to avoid bloat and to fix
     paths to the directory Manual . -->
<!-- $.treeview -->
<!-- $.search -->
<link href="navtree.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="../Manual/resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="../Manual/search/searchdata.js"></script>
<script type="text/javascript" src="../Manual/search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="../Manual/search/search.js"></script>
<!-- Manually done below. -->
<link href="../Manual/doxygen.css" rel="stylesheet" type="text/css">
<link href="../Manual/cgal_stylesheet.css" rel="stylesheet" type="text/css">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
//<![CDATA[
MathJax.Hub.Config(
{
  TeX: {
      Macros: {
          qprel: [ "{\\gtreqless}", 0],
          qpx: [ "{\\mathbf{x}}", 0],
          qpl: [ "{\\mathbf{l}}", 0],
          qpu: [ "{\\mathbf{u}}", 0],
          qpc: [ "{\\mathbf{c}}", 0],
          qpb: [ "{\\mathbf{b}}", 0],
          qpy: [ "{\\mathbf{y}}", 0],
          qpw: [ "{\\mathbf{w}}", 0],
          qplambda: [ "{\\mathbf{\\lambda}}", 0],
          ssWpoint: [ "{\\bf #1}", 1],
          ssWeight: [ "{w_{#1}}", 1],
          dabs: [ "{\\parallel\\! #1 \\!\\parallel}", 1],
          E: [ "{\\mathrm{E}}", 0],
          A: [ "{\\mathrm{A}}", 0],
          R: [ "{\\mathrm{R}}", 0],
          N: [ "{\\mathrm{N}}", 0],
          Q: [ "{\\mathrm{Q}}", 0],
          Z: [ "{\\mathrm{Z}}", 0],
          ccSum: [ "{\\sum_{#1}^{#2}{#3}}", 3],
          ccProd: [ "{\\prod_{#1}^{#2}{#3}}", 3],
          pyr: [ "{\\operatorname{Pyr}}", 0],
          aff: [ "{\\operatorname{aff}}", 0],
          Ac: [ "{\\cal A}", 0],
          Sc: [ "{\\cal S}", 0],
      },
      equationNumbers: { autoNumber: "AMS" }
  }
}
);
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  var PARSE = MathJax.InputJax.TeX.Parse,
      TEXT = PARSE.prototype.InternalText;
  PARSE.Augment({
    InternalText: function (text,def) {
      text = text.replace(/\\/g,"");
      return TEXT.call(this,text,def);
    }
  });
});
//]]>
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<script src="modules.js" type="text/javascript"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="back-nav">
  <ul>
    <li><a href="https://www.cgal.org/">cgal.org</a></li>
    <li><a href="../Manual/index.html">Top</a></li>
    <li><a href="../Manual/general_intro.html">Getting Started</a></li>
    <li><a href="../Manual/tutorials.html">Tutorials</a></li>
    <li><a href="../Manual/packages.html">Package Overview</a></li>
    <li><a href="../Manual/how_to_cite_cgal.html">Acknowledging CGAL</a></li>
  </ul>
  <!-- In a package SEARCHENGINE = false, so we cannot use 
       insertion. That's why we have to do it manually here. Notice
       that we also take pngs from the Manual. -->
  <div id="MSearchBox" class="MSearchBoxInactive">
      <span class="left">
         <span id="MSearchSelect" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()">Â 
        </span>
        <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)">
      </span>
      <span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../Manual/search/close.svg" alt=""></a>
      </span>
  </div>
</div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CGAL 6.2 - Tetrahedral Remeshing
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Code below is usually inserted by doxygen when SEARCHENGINE =
     true. Notice that the path to the search directory is adjusted to
     the top-level.-->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../Manual/search/",'.html');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync" style="display: none"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">User Manual </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Chapter_Tetrahedral_Remeshing"></a><a class="anchor" id="userchaptertetrahedralremeshing"></a> </p> <div id="autotoc" class="toc"></div>  <dl class="section author"><dt>Authors</dt><dd>Jane Tournois, Noura Faraj, Jean-Marc Thiery, Tamy Boubekeur</dd></dl>
<div class="image">
<img src="bimba_back.png" alt="">
</div>
<p>  <br>
</p>
<h1><a class="anchor" id="secTetRemeshing"></a>
Multi-Material Isotropic Tetrahedral Remeshing</h1>
<p>This package implements an algorithm for quality tetrahedral remeshing, introduced by Faraj et al in <a class="el" href="citelist.html#CITEREF_faraj2016mvr">[1]</a>. This practical iterative remeshing algorithm is designed to remesh multi-material tetrahedral meshes, by iteratively performing a sequence of elementary operations such as edge splits, edge collapses, edge flips, and vertex relocations following a Laplacian smoothing. The algorithm results in high-quality uniform isotropic meshes, with the desired mesh density, while preserving the input geometric curve and surface features.</p>
<h2><a class="anchor" id="ssecAlgorithm"></a>
Remeshing Algorithm</h2>
<p>Specific remeshing rules have been designed to satisfy the following criteria. First, the algorithm preserves the geometric complex topology, including multi-material surface patches and polyline features. Polyline features can be defined as intersections between more than two subdomains, or listed by the user. Second, it has been made possible to remesh only a selection of cells, instead of remeshing the whole domain, while preserving or remeshing the interface surfaces between the preserved and the remeshed tetrahedra.</p>
<p>All the local atomic operations that are performed by the algorithm preserve the input topology of the geometric complex.</p>
<p>The tetrahedral remeshing algorithm improves the quality of dihedral angles, while targeting the user-defined uniform sizing field and preserving the topology of the feature complex, as highlighted by <a class="el" href="index.html#fig__Remesh_liver">Figure 65.1</a>.</p>
<p>Experimental evidence shows that a higher number of remeshing iterations leads to a mesh with a improved fidelity to the sizing criterion, and higher quality dihedral angles.</p>
<p><a class="anchor" id="fig__Remesh_liver"></a> </p><div class="image">
<img src="tetrahedral_remeshing_before_after.png" alt="">
</div>
   <div class="cgal_figure_caption"> <p>  <a class="el" href="index.html#fig__Remesh_liver">Figure 65.1</a> Tetrahedral mesh, modified by our tetrahedral remeshing method. (Left) Before remeshing, dihedral angles were in the interval [1.3; 177.8]. (Right) After remeshing and keeping the same density, dihedral angles are in the interval [12,7; 157.7]. </p> </div> <p> <br>
</p>
<h2><a class="anchor" id="ssecSizing"></a>
Sizing Field</h2>
<p>Tetrahedral isotropic remeshing algorithm is led by a target sizing field, that can be either uniform, adaptive, or custom.</p>
<p>The sizing field establishes the local target edge length for the remeshed tetrahedra. Two sizing fields are provided: a uniform and a mesh-adaptive sizing field. With <code><a class="el" href="classCGAL_1_1Uniform__sizing__field.html">CGAL::Uniform_sizing_field</a></code>, all tetrahedra edges are targeted to have equal lengths, as depicted in Section <a class="el" href="index.html#secTetRemeshing">Multi-Material Isotropic Tetrahedral Remeshing</a> . With <code><a class="el" href="classCGAL_1_1Adaptive__remeshing__sizing__field.html">CGAL::Adaptive_remeshing_sizing_field</a></code>, tetrahedra edge lengths remain locally close to the local size of simplices in the input mesh.</p>
<p>The difference between remeshing with uniform and adaptive sizing fields is depicted in <a class="el" href="index.html#fig__uniform_and_adaptive_tet">Figure 65.2</a>.</p>
<p><a class="anchor" id="fig__uniform_and_adaptive_tet"></a> </p><div class="image">
<img src="uniform_and_adaptive_remeshing.png" alt="">
</div>
   <div class="cgal_figure_caption"> <p>  <a class="el" href="index.html#fig__uniform_and_adaptive_tet">Figure 65.2</a> Tetrahedral mesh, modified by our tetrahedral remeshing method. (Left) Before remeshing; dihedral angles in the interval [0.1; 179.8], 33,936 vertices. (Middle) After remeshing with uniform sizing field, targeting the average edge length of input (left) mesh; dihedral angles in the interval [9.8; 165.5], 301,127 vertices. (Right) After remeshing with adaptive sizing field; dihedral angles in the interval [6.8; 166.2], 38,602 vertices. </p> </div> <p> <br>
</p>
<p>It is also possible to use a custom sizing function, like for example the same sizing field as the one used for initial tetrahedral mesh generation using the CGAL <a class="elRef" href="../Manual/packages.html#PkgMesh3">3D Mesh Generation</a> package, and consecutive consistent isotropic remeshing, as shown by <a class="el" href="index.html#fig__sphere_sizing_field">Figure 65.3</a>. Note that the remeshed version is denser than the one generated by <code><a class="elRef" href="../Mesh_3/group__PkgMesh3Functions.html#gac8599a0c967075f740bf8e2e92c4770e">CGAL::make_mesh_3()</a></code>. This happens because here, the sizing field is used both as a lower and an upper bound for edge lengths, whereas in mesh generation it is used only as an upper bound on simplex sizes.</p>
<p><a class="anchor" id="fig__sphere_sizing_field"></a> </p><div class="image">
<img src="sphere_with_sizing.png" alt="">
</div>
   <div class="cgal_figure_caption"> <p>  <a class="el" href="index.html#fig__sphere_sizing_field">Figure 65.3</a> Tetrahedral mesh, modified by our uniform tetrahedral remeshing method. (Left) Before remeshing, dihedral angles were in the interval <code>[0.2; 179.7]</code>. (Middle) After remeshing with a uniform target edge length equal to the average edge length of the input mesh. Dihedral angles are in the interval <code>[13.2; 157.3]</code>. (Right) After remeshing with the same sizing field as the one used for mesh generation. Dihedral angles are in the interval <code>[10.4; 162.3]</code>. </p> </div> <p> <br>
</p>
<h1><a class="anchor" id="secTetRemeshingAPI"></a>
API</h1>
<p>The tetrahedral remeshing algorithm is implemented as a single free function <code><a class="el" href="group__PkgTetrahedralRemeshingRef.html#ga263775c52eeb483a86a16aeb9eb31af0" title="remeshes a tetrahedral mesh.">CGAL::tetrahedral_isotropic_remeshing()</a></code> that takes only two required parameters: the input triangulation, and the desired edge length or sizing field, which drives the remeshing process.</p>
<p><a class="elRef" href="../BGL/index.html#BGLNamedParameters">Named Parameters</a> are used to deal with optional parameters. The page <a class="elRef" href="../BGL/group__bgl__namedparameters.html">Named Parameters</a> describes their usage.</p>
<h1><a class="anchor" id="secTetRemeshingExamples"></a>
Examples</h1>
<h2><a class="anchor" id="ssecEx1"></a>
Tetrahedral Remeshing Example</h2>
<p>The following example shows the simplest use of the tetrahedral remeshing function. The only required parameter is a given target edge length that drives the remeshing process towards a high-quality tetrahedral mesh with improved dihedral angles, and a more uniform mesh, with edge lengths getting closer to the input parameter value.</p>
<p>By default, the cells with a non-zero <code>Subdomain_index</code> are selected for remeshing. The cells with <code>Subdomain_index</code> equal to zero are ignored by the remeshing algorithm.</p>
<p><b>Example: </b> <a class="el" href="Tetrahedral_remeshing_2tetrahedral_remeshing_example_8cpp-example.html">Tetrahedral_remeshing/tetrahedral_remeshing_example.cpp</a> <br>
</p><details>
<summary>
Show / Hide</summary>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Tetrahedral_remeshing/Remeshing_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/tetrahedral_remeshing.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include "tetrahedral_remeshing_generate_input.h"</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_classRef" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_class" href="classCGAL_1_1Tetrahedral__remeshing_1_1Remeshing__triangulation__3.html">CGAL::Tetrahedral_remeshing::Remeshing_triangulation_3&lt;K&gt;</a> Remeshing_triangulation;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> target_edge_length = (argc &gt; 1) ? atof(argv[1]) : 0.1;</div>
<div class="line">  <span class="keyword">const</span> std::size_t nbv = (argc &gt; 2) ? atoi(argv[2]) : 1000;</div>
<div class="line"> </div>
<div class="line">  Remeshing_triangulation tr;</div>
<div class="line">  CGAL::Tetrahedral_remeshing::insert_random_points_in_cube(nbv, tr);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> cell : tr.finite_cell_handles())</div>
<div class="line">    cell-&gt;set_subdomain_index(1);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#ga263775c52eeb483a86a16aeb9eb31af0">CGAL::tetrahedral_isotropic_remeshing</a>(tr, target_edge_length);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="aclassCGAL_1_1Exact__predicates__inexact__constructions__kernel_html"><div class="ttname"><a href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a></div></div>
<div class="ttc" id="aclassCGAL_1_1Tetrahedral__remeshing_1_1Remeshing__triangulation__3_html"><div class="ttname"><a href="classCGAL_1_1Tetrahedral__remeshing_1_1Remeshing__triangulation__3.html">CGAL::Tetrahedral_remeshing::Remeshing_triangulation_3</a></div><div class="ttdoc">The class Remeshing_triangulation_3 is a class template which provides a valid triangulation type tha...</div><div class="ttdef"><b>Definition:</b> Remeshing_triangulation_3.h:59</div></div>
<div class="ttc" id="agroup__PkgTetrahedralRemeshingRef_html_ga263775c52eeb483a86a16aeb9eb31af0"><div class="ttname"><a href="group__PkgTetrahedralRemeshingRef.html#ga263775c52eeb483a86a16aeb9eb31af0">CGAL::tetrahedral_isotropic_remeshing</a></div><div class="ttdeci">void tetrahedral_isotropic_remeshing(CGAL::Triangulation_3&lt; Traits, TDS, SLDS &gt; &amp;tr, const SizingFunction &amp;sizing, const NamedParameters &amp;np=parameters::default_values())</div><div class="ttdoc">remeshes a tetrahedral mesh.</div><div class="ttdef"><b>Definition:</b> tetrahedral_remeshing.h:187</div></div>
</div><!-- fragment --> </details>
<h2><a class="anchor" id="ssecEx2"></a>
Tetrahedral Remeshing of a Selection</h2>
<p>Optional BGL named parameters offer more precise control on the remeshing process. In this example, a triangulation with two subdomains (defined by indices stored in cells) is given as input, but only one (defined by the <code>Subdomain_index</code> 2) of its subdomains is remeshed.</p>
<p>Only the cells with a non-zero <code>Subdomain_index</code> will be remeshed. The named parameter <code>cell_is_selected_map</code> can be used to change this behavior.</p>
<p><b>Example: </b> <a class="el" href="Tetrahedral_remeshing_2tetrahedral_remeshing_of_one_subdomain_8cpp-example.html">Tetrahedral_remeshing/tetrahedral_remeshing_of_one_subdomain.cpp</a> <br>
</p><details>
<summary>
Show / Hide</summary>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Tetrahedral_remeshing/Remeshing_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/tetrahedral_remeshing.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/property_map.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include "tetrahedral_remeshing_generate_input.h"</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>K = <a class="code hl_classRef" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>Remeshing_triangulation = <a class="code hl_class" href="classCGAL_1_1Tetrahedral__remeshing_1_1Remeshing__triangulation__3.html">CGAL::Tetrahedral_remeshing::Remeshing_triangulation_3&lt;K&gt;</a>;</div>
<div class="line"><span class="keyword">using </span>Subdomain_index = Remeshing_triangulation::Tds::Cell::Subdomain_index;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tr&gt;</div>
<div class="line"><span class="keyword">struct </span>Cells_of_subdomain_pmap</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> m_subdomain;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">using </span>key_type = <span class="keyword">typename</span> Tr::Cell_handle;</div>
<div class="line">  <span class="keyword">using </span>value_type = bool;</div>
<div class="line">  <span class="keyword">using </span>reference = bool;</div>
<div class="line">  <span class="keyword">using </span>category = boost::read_write_property_map_tag;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">friend</span> value_type get(<span class="keyword">const</span> Cells_of_subdomain_pmap&amp; map,</div>
<div class="line">                        <span class="keyword">const</span> key_type&amp; c)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">return</span> (map.m_subdomain == c-&gt;subdomain_index());</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">friend</span> <span class="keywordtype">void</span> put(Cells_of_subdomain_pmap&amp;,</div>
<div class="line">                  <span class="keyword">const</span> key_type&amp;,</div>
<div class="line">                  <span class="keyword">const</span> value_type)</div>
<div class="line">  {</div>
<div class="line">    ; <span class="comment">//nothing to do : subdomain indices are updated in remeshing</span></div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">Subdomain_index subdomain_on_side_of_plane(<span class="keyword">const</span> K::Point_3&amp; p,</div>
<div class="line">                                           <span class="keyword">const</span> K::Plane_3&amp; plane)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (plane.has_on_positive_side(p))</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">return</span> 2;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">K::Point_3 <a class="code hl_functionRef" href="../Kernel_23/group__centroid__grp.html#ga3ba0496a839f97ee6cd506baff51dfe4">centroid</a>(<span class="keyword">const</span> Remeshing_triangulation::Cell_handle c)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_functionRef" href="../Kernel_23/group__centroid__grp.html#ga3ba0496a839f97ee6cd506baff51dfe4">CGAL::centroid</a>(c-&gt;vertex(0)-&gt;point(),</div>
<div class="line">                        c-&gt;vertex(1)-&gt;point(),</div>
<div class="line">                        c-&gt;vertex(2)-&gt;point(),</div>
<div class="line">                        c-&gt;vertex(3)-&gt;point());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> target_edge_length = (argc &gt; 1) ? atof(argv[1]) : 0.05;</div>
<div class="line">  <span class="keyword">const</span> std::size_t nbv = (argc &gt; 2) ? atoi(argv[2]) : 1000;</div>
<div class="line">  <span class="keyword">const</span> std::size_t nbv_on_plane = (argc &gt; 3) ? atoi(argv[3]) : 100;</div>
<div class="line"> </div>
<div class="line">  Remeshing_triangulation tr;</div>
<div class="line">  CGAL::Tetrahedral_remeshing::insert_random_points_in_cube(nbv, tr);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> K::Plane_3 plane(0, 0, 1, 0);</div>
<div class="line">  CGAL::Tetrahedral_remeshing::insert_points_on_plane(plane, nbv_on_plane, tr);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> cell : tr.finite_cell_handles())</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> K::Point_3 cc = <a class="code hl_functionRef" href="../Kernel_23/group__centroid__grp.html#ga3ba0496a839f97ee6cd506baff51dfe4">centroid</a>(cell);</div>
<div class="line">    cell-&gt;set_subdomain_index(subdomain_on_side_of_plane(cc, plane));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#ga263775c52eeb483a86a16aeb9eb31af0">CGAL::tetrahedral_isotropic_remeshing</a>(tr,</div>
<div class="line">      target_edge_length,</div>
<div class="line">      CGAL::parameters::cell_is_selected_map(</div>
<div class="line">        Cells_of_subdomain_pmap&lt;Remeshing_triangulation&gt;{2}));</div>
<div class="line"> </div>
<div class="line">  std::ofstream os(<span class="stringliteral">"out.mesh"</span>);</div>
<div class="line">  <a class="code hl_functionRef" href="../SMDS_3/group__PkgSMDS3IOFunctions.html#ga9e9fc0fac6919241501c228e438fa2b2">CGAL::IO::write_MEDIT</a>(os, tr);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="ttc" id="agroup__PkgSMDS3IOFunctions_html_ga9e9fc0fac6919241501c228e438fa2b2"><div class="ttname"><a href="../SMDS_3/group__PkgSMDS3IOFunctions.html#ga9e9fc0fac6919241501c228e438fa2b2">CGAL::IO::write_MEDIT</a></div><div class="ttdeci">void write_MEDIT(std::ostream &amp;os, const T3 &amp;t3, const NamedParameters &amp;np=parameters::default_values())</div></div>
<div class="ttc" id="agroup__centroid__grp_html_ga3ba0496a839f97ee6cd506baff51dfe4"><div class="ttname"><a href="../Kernel_23/group__centroid__grp.html#ga3ba0496a839f97ee6cd506baff51dfe4">CGAL::centroid</a></div><div class="ttdeci">CGAL::Point_2&lt; Kernel &gt; centroid(const CGAL::Point_2&lt; Kernel &gt; &amp;p, const CGAL::Point_2&lt; Kernel &gt; &amp;q, const CGAL::Point_2&lt; Kernel &gt; &amp;r)</div></div>
</div><!-- fragment --> </details>
<h2><a class="anchor" id="ssecEx3"></a>
Tetrahedral Remeshing With Polyline Features</h2>
<p>Optional BGL named parameters offer more precise control on the remeshing process. In this example, a triangulation with polyline features that should be preserved - though resampled - during the remeshing process, is given as input. Preserving all surfaces exactly could also be achieved by setting the named parameter <code>remesh_boundaries</code> to <code>false</code>.</p>
<p><b>Example: </b> <a class="el" href="Tetrahedral_remeshing_2tetrahedral_remeshing_with_features_8cpp-example.html">Tetrahedral_remeshing/tetrahedral_remeshing_with_features.cpp</a> <br>
</p><details>
<summary>
Show / Hide</summary>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Tetrahedral_remeshing/Remeshing_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/tetrahedral_remeshing.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/property_map.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include "tetrahedral_remeshing_generate_input.h"</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>K = <a class="code hl_classRef" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>Remeshing_triangulation = <a class="code hl_class" href="classCGAL_1_1Tetrahedral__remeshing_1_1Remeshing__triangulation__3.html">CGAL::Tetrahedral_remeshing::Remeshing_triangulation_3&lt;K&gt;</a>;</div>
<div class="line"><span class="keyword">using </span>Point = Remeshing_triangulation::Point;</div>
<div class="line"><span class="keyword">using </span>Vertex_handle = Remeshing_triangulation::Vertex_handle;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>Vertex_pair = std::pair&lt;Vertex_handle, Vertex_handle&gt;;</div>
<div class="line"><span class="keyword">using </span>Constraints_set = std::unordered_set&lt;Vertex_pair, boost::hash&lt;Vertex_pair&gt;&gt;;</div>
<div class="line"><span class="keyword">using </span>Constraints_pmap = CGAL::Boolean_property_map&lt;Constraints_set&gt;;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> target_edge_length = (argc &gt; 1) ? atof(argv[1]) : 0.02;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_iter = (argc &gt; 2) ? atoi(argv[2]) : 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nbv = (argc &gt; 3) ? atoi(argv[3]) : 500;</div>
<div class="line"> </div>
<div class="line">  Remeshing_triangulation t3;</div>
<div class="line"> </div>
<div class="line">  Constraints_set constraints;</div>
<div class="line">  CGAL::Tetrahedral_remeshing::generate_input_cube(nbv, t3, constraints);</div>
<div class="line">  make_constraints_from_cube_edges(t3, constraints);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#ga263775c52eeb483a86a16aeb9eb31af0">CGAL::tetrahedral_isotropic_remeshing</a>(t3, target_edge_length,</div>
<div class="line">    CGAL::parameters::edge_is_constrained_map(Constraints_pmap(constraints))</div>
<div class="line">                     .number_of_iterations(nb_iter));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
</div><!-- fragment --> </details>
<p>It is also possible to define the polyline features as the ones stored as complex edges in a <code><a class="elRef" href="../SMDS_3/classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">Mesh_complex_3_in_triangulation_3</a></code> (e.g., generated by the <a class="elRef" href="../Manual/packages.html#PkgMesh3">3D Mesh Generation</a> package).</p>
<p><b>Example: </b> <a class="el" href="Tetrahedral_remeshing_2mesh_and_remesh_c3t3_8cpp-example.html">Tetrahedral_remeshing/mesh_and_remesh_c3t3.cpp</a> <br>
</p><details>
<summary>
Show / Hide</summary>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedral_mesh_domain_with_features_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/property_map.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/tetrahedral_remeshing.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/IO/File_medit.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unordered_set&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Domain</span></div>
<div class="line"><span class="keyword">using </span>K = <a class="code hl_classRef" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a>;</div>
<div class="line"><span class="keyword">using </span>Polyhedron = <a class="code hl_classRef" href="../Manual/classunspecified__type.html">CGAL::Mesh_polyhedron_3&lt;K&gt;::type</a>;</div>
<div class="line"><span class="keyword">using </span>Mesh_domain = <a class="code hl_classRef" href="../Mesh_3/classCGAL_1_1Polyhedral__mesh__domain__with__features__3.html">CGAL::Polyhedral_mesh_domain_with_features_3&lt;K&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div>
<div class="line"><span class="keyword">using </span>Concurrency_tag = <a class="code hl_structRef" href="../STL_Extension/structCGAL_1_1Parallel__if__available__tag.html">CGAL::Parallel_if_available_tag</a>;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="keyword">using </span>Concurrency_tag = <a class="code hl_structRef" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Triangulation for Meshing</span></div>
<div class="line"><span class="keyword">using </span>Tr = <a class="code hl_classRef" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain, CGAL::Default, Concurrency_tag&gt;::type</a>;</div>
<div class="line"><span class="keyword">using </span>C3t3 = <a class="code hl_classRef" href="../SMDS_3/classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3</a>&lt;</div>
<div class="line">  Tr, Mesh_domain::Corner_index, Mesh_domain::Curve_index&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Criteria</span></div>
<div class="line"><span class="keyword">using </span>Mesh_criteria = <a class="code hl_classRef" href="../Mesh_3/classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Triangulation for Remeshing</span></div>
<div class="line"><span class="keyword">using </span>Triangulation_3 = <a class="code hl_classRef" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html">CGAL::Triangulation_3</a>&lt;Tr::Geom_traits,</div>
<div class="line">                             Tr::Triangulation_data_structure&gt;;</div>
<div class="line"><span class="keyword">using </span>Vertex_handle = <a class="code hl_typedefRef" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html#a1ba56e37b3a5acb1ba49a56d9d101a19">Triangulation_3::Vertex_handle</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>Vertex_pair = std::pair&lt;Vertex_handle, Vertex_handle&gt;;</div>
<div class="line"><span class="keyword">using </span>Constraints_set = std::unordered_set&lt;Vertex_pair, boost::hash&lt;Vertex_pair&gt;&gt;;</div>
<div class="line"><span class="keyword">using </span>Constraints_pmap = CGAL::Boolean_property_map&lt;Constraints_set&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>Corners_set = std::unordered_set&lt;Vertex_handle, boost::hash&lt;Vertex_handle&gt;&gt;;</div>
<div class="line"><span class="keyword">using </span>Corners_pmap = CGAL::Boolean_property_map&lt;Corners_set&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespaceRef" href="../STL_Extension/namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> std::string fname = (argc &gt; 1) ? argv[1] : <a class="code hl_functionRef" href="../Manual/namespaceCGAL.html#acdae9a147ad2a3998cc21f88bc292dac">CGAL::data_file_path</a>(<span class="stringliteral">"meshes/fandisk.off"</span>);</div>
<div class="line">  std::ifstream input(fname);</div>
<div class="line">  Polyhedron polyhedron;</div>
<div class="line">  input &gt;&gt; polyhedron;</div>
<div class="line">  <span class="keywordflow">if</span> (input.fail() || !<a class="code hl_functionRef" href="../BGL/group__PkgBGLHelperFct.html#ga11883d231eec1b58f37efe4acedd9588">CGAL::is_triangle_mesh</a>(polyhedron)) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Input invalid "</span> &lt;&lt; fname &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create domain</span></div>
<div class="line">  Mesh_domain domain(polyhedron);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Get sharp features</span></div>
<div class="line">  domain.detect_features();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Mesh criteria</span></div>
<div class="line">  Mesh_criteria criteria(edge_size = 0.025,</div>
<div class="line">    facet_angle = 25, facet_size = 0.05, facet_distance = 0.005,</div>
<div class="line">    cell_radius_edge_ratio = 3, cell_size = 0.05);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Mesh generation</span></div>
<div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Property map of constraints</span></div>
<div class="line">  Constraints_set constraints;</div>
<div class="line">  Constraints_pmap constraints_pmap(constraints);</div>
<div class="line"> </div>
<div class="line">  Corners_set corners;</div>
<div class="line">  Corners_pmap corners_pmap(corners);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_classRef" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html">Triangulation_3</a> tr = <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#gacbc8c23061a2db7654c2ef9209adcfb2">CGAL::convert_to_triangulation_3</a>(std::move(c3t3),</div>
<div class="line">                      edge_is_constrained_map(constraints_pmap).</div>
<div class="line">                      vertex_is_constrained_map(corners_pmap));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//note we use the move semantic, with std::move(c3t3),</span></div>
<div class="line">  <span class="comment">//  to avoid a copy of the triangulation by the function</span></div>
<div class="line">  <span class="comment">//  `CGAL::convert_to_triangulation_3()`</span></div>
<div class="line">  <span class="comment">//  After the call to this function, c3t3 is an empty and valid C3t3.</span></div>
<div class="line">  <span class="comment">//It is possible to use :  CGAL::convert_to_triangulation_3(c3t3),</span></div>
<div class="line">  <span class="comment">//  Then the triangulation is copied and duplicated, and c3t3 remains as is.</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> target_edge_length = 0.1;<span class="comment">//coarsen the mesh</span></div>
<div class="line">  <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#ga263775c52eeb483a86a16aeb9eb31af0">CGAL::tetrahedral_isotropic_remeshing</a>(tr, target_edge_length,</div>
<div class="line">   number_of_iterations(5)</div>
<div class="line">   .smooth_constrained_edges(<span class="keyword">true</span>)</div>
<div class="line">   .edge_is_constrained_map(constraints_pmap));</div>
<div class="line"> </div>
<div class="line">  std::ofstream out(<span class="stringliteral">"out_remeshed.mesh"</span>);</div>
<div class="line">  <a class="code hl_functionRef" href="../SMDS_3/group__PkgSMDS3IOFunctions.html#ga9e9fc0fac6919241501c228e438fa2b2">CGAL::IO::write_MEDIT</a>(out, tr);</div>
<div class="line">  out.close();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="aclassCGAL_1_1Mesh__complex__3__in__triangulation__3_html"><div class="ttname"><a href="../SMDS_3/classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3</a></div></div>
<div class="ttc" id="aclassCGAL_1_1Mesh__criteria__3_html"><div class="ttname"><a href="../Mesh_3/classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3</a></div></div>
<div class="ttc" id="aclassCGAL_1_1Polyhedral__mesh__domain__with__features__3_html"><div class="ttname"><a href="../Mesh_3/classCGAL_1_1Polyhedral__mesh__domain__with__features__3.html">CGAL::Polyhedral_mesh_domain_with_features_3</a></div></div>
<div class="ttc" id="aclassCGAL_1_1Triangulation__3_html"><div class="ttname"><a href="../Triangulation_3/classCGAL_1_1Triangulation__3.html">CGAL::Triangulation_3</a></div></div>
<div class="ttc" id="aclassCGAL_1_1Triangulation__3_html_a1ba56e37b3a5acb1ba49a56d9d101a19"><div class="ttname"><a href="../Triangulation_3/classCGAL_1_1Triangulation__3.html#a1ba56e37b3a5acb1ba49a56d9d101a19">CGAL::Triangulation_3::Vertex_handle</a></div><div class="ttdeci">Triangulation_data_structure::Vertex_handle Vertex_handle</div></div>
<div class="ttc" id="aclassunspecified__type_html"><div class="ttname"><a href="../Manual/classunspecified__type.html">unspecified_type</a></div></div>
<div class="ttc" id="agroup__PkgBGLHelperFct_html_ga11883d231eec1b58f37efe4acedd9588"><div class="ttname"><a href="../BGL/group__PkgBGLHelperFct.html#ga11883d231eec1b58f37efe4acedd9588">CGAL::is_triangle_mesh</a></div><div class="ttdeci">bool is_triangle_mesh(const FaceGraph &amp;g)</div></div>
<div class="ttc" id="agroup__PkgTetrahedralRemeshingRef_html_gacbc8c23061a2db7654c2ef9209adcfb2"><div class="ttname"><a href="group__PkgTetrahedralRemeshingRef.html#gacbc8c23061a2db7654c2ef9209adcfb2">CGAL::convert_to_triangulation_3</a></div><div class="ttdeci">CGAL::Triangulation_3&lt; typename Tr::Geom_traits, typename Tr::Triangulation_data_structure &gt; convert_to_triangulation_3(CGAL::Mesh_complex_3_in_triangulation_3&lt; Tr, CornerIndex, CurveIndex &gt; c3t3, const NamedParameters &amp;np=parameters::default_values())</div><div class="ttdoc">converts the triangulation contained in the input to a Triangulation_3.</div><div class="ttdef"><b>Definition:</b> tetrahedral_remeshing.h:357</div></div>
<div class="ttc" id="anamespaceCGAL_1_1parameters_html"><div class="ttname"><a href="../STL_Extension/namespaceCGAL_1_1parameters.html">CGAL::parameters</a></div></div>
<div class="ttc" id="anamespaceCGAL_html_acdae9a147ad2a3998cc21f88bc292dac"><div class="ttname"><a href="../Manual/namespaceCGAL.html#acdae9a147ad2a3998cc21f88bc292dac">CGAL::data_file_path</a></div><div class="ttdeci">std::string data_file_path(const std::string &amp;filename)</div></div>
<div class="ttc" id="astructCGAL_1_1Parallel__if__available__tag_html"><div class="ttname"><a href="../STL_Extension/structCGAL_1_1Parallel__if__available__tag.html">CGAL::Parallel_if_available_tag</a></div></div>
<div class="ttc" id="astructCGAL_1_1Sequential__tag_html"><div class="ttname"><a href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a></div></div>
</div><!-- fragment --> </details>
<h2><a class="anchor" id="ssecEx4"></a>
Tetrahedral Remeshing After Mesh Generation</h2>
<p>The tetrahedral remeshing algorithm is designed as a postprocessing for mesh generation algorithms. The API allows to generate a tetrahedral mesh with the CGAL <a class="elRef" href="../Manual/packages.html#PkgMesh3">3D Mesh Generation</a> package, and further improve it with the tetrahedral remeshing algorithm. This example shows how to use tetrahedral mesh generation and remeshing in sequence, from a polyhedral domain with features.</p>
<p><b>Example: </b> <a class="el" href="Tetrahedral_remeshing_2mesh_and_remesh_polyhedral_domain_with_features_8cpp-example.html">Tetrahedral_remeshing/mesh_and_remesh_polyhedral_domain_with_features.cpp</a> <br>
</p><details>
<summary>
Show / Hide</summary>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Surface_mesh.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedral_mesh_domain_with_features_3.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/tetrahedral_remeshing.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/property_map.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/IO/File_medit.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unordered_set&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Domain</span></div>
<div class="line"><span class="keyword">using </span>K = <a class="code hl_classRef" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a>;</div>
<div class="line"><span class="keyword">using </span>Surface_mesh = CGAL::Surface_mesh&lt;K::Point_3&gt;;</div>
<div class="line"><span class="keyword">using </span>Mesh_domain = <a class="code hl_classRef" href="../Mesh_3/classCGAL_1_1Polyhedral__mesh__domain__with__features__3.html">CGAL::Polyhedral_mesh_domain_with_features_3&lt;K, Surface_mesh&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div>
<div class="line"><span class="keyword">using </span>Concurrency_tag = <a class="code hl_structRef" href="../STL_Extension/structCGAL_1_1Parallel__if__available__tag.html">CGAL::Parallel_if_available_tag</a>;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="keyword">using </span>Concurrency_tag = <a class="code hl_structRef" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Triangulation</span></div>
<div class="line"><span class="keyword">using </span>Tr = <a class="code hl_classRef" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain, CGAL::Default, Concurrency_tag&gt;::type</a>;</div>
<div class="line"><span class="keyword">using </span>C3t3 = <a class="code hl_classRef" href="../SMDS_3/classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3</a>&lt;</div>
<div class="line">  Tr, Mesh_domain::Corner_index, Mesh_domain::Curve_index&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Criteria</span></div>
<div class="line"><span class="keyword">using </span>Mesh_criteria = <a class="code hl_classRef" href="../Mesh_3/classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Triangulation for Remeshing</span></div>
<div class="line"><span class="keyword">using </span><a class="code hl_classRef" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html">Triangulation_3</a> = <a class="code hl_classRef" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html">CGAL::Triangulation_3</a>&lt;Tr::Geom_traits,</div>
<div class="line">                                              Tr::Triangulation_data_structure&gt;;</div>
<div class="line"><span class="keyword">using </span>Vertex_handle = <a class="code hl_typedefRef" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html#a1ba56e37b3a5acb1ba49a56d9d101a19">Triangulation_3::Vertex_handle</a>;</div>
<div class="line"><span class="keyword">using </span>Vertex_pair = std::pair&lt;Vertex_handle, Vertex_handle&gt;;</div>
<div class="line"><span class="keyword">using </span>Constraints_set = std::unordered_set&lt;Vertex_pair, boost::hash&lt;Vertex_pair&gt;&gt;;</div>
<div class="line"><span class="keyword">using </span>Constraints_pmap = CGAL::Boolean_property_map&lt;Constraints_set&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespaceRef" href="../STL_Extension/namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> std::string fname = (argc &gt; 1) ? argv[1] : <a class="code hl_functionRef" href="../Manual/namespaceCGAL.html#acdae9a147ad2a3998cc21f88bc292dac">CGAL::data_file_path</a>(<span class="stringliteral">"meshes/fandisk.off"</span>);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_iter = (argc &gt; 2) ? atoi(argv[2]) : 5;</div>
<div class="line"> </div>
<div class="line">  std::ifstream input(fname);</div>
<div class="line">  Surface_mesh mesh;</div>
<div class="line"> </div>
<div class="line">  std::string filename(fname);</div>
<div class="line">  input &gt;&gt; mesh;</div>
<div class="line">  <span class="keywordflow">if</span> (input.fail()) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt; fname &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_functionRef" href="../BGL/group__PkgBGLHelperFct.html#ga11883d231eec1b58f37efe4acedd9588">CGAL::is_triangle_mesh</a>(mesh)) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Input geometry is not triangulated."</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create domain</span></div>
<div class="line">  Mesh_domain domain(mesh);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Get sharp features</span></div>
<div class="line">  domain.detect_features();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Mesh criteria</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> size = 0.072;</div>
<div class="line">  Mesh_criteria criteria(edge_size = size,</div>
<div class="line">                         facet_angle = 25,</div>
<div class="line">                         facet_size = size,</div>
<div class="line">                         facet_distance = 0.1 * size,</div>
<div class="line">                         cell_radius_edge_ratio = 2,</div>
<div class="line">                         cell_size = size);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Mesh generation</span></div>
<div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria, <a class="code hl_functionRef" href="../Mesh_3/group__PkgMesh3Parameters.html#ga9f696ff6caf3c4efd246e43946a89294">no_perturb</a>(), <a class="code hl_functionRef" href="../Mesh_3/group__PkgMesh3Parameters.html#gab24d8652fbb6ae045e989769c5bc69f0">no_exude</a>());</div>
<div class="line"> </div>
<div class="line">  Constraints_set constraints;</div>
<div class="line">  Constraints_pmap constraints_pmap(constraints);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_classRef" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html">Triangulation_3</a> tr = <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#gacbc8c23061a2db7654c2ef9209adcfb2">CGAL::convert_to_triangulation_3</a>(std::move(c3t3),</div>
<div class="line">    edge_is_constrained_map(constraints_pmap));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Remeshing</span></div>
<div class="line">  <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#ga263775c52eeb483a86a16aeb9eb31af0">CGAL::tetrahedral_isotropic_remeshing</a>(tr, size,</div>
<div class="line">    number_of_iterations(nb_iter)</div>
<div class="line">    .edge_is_constrained_map(constraints_pmap));</div>
<div class="line"> </div>
<div class="line">  std::ofstream out(<span class="stringliteral">"out_remeshed.mesh"</span>);</div>
<div class="line">  <a class="code hl_functionRef" href="../SMDS_3/group__PkgSMDS3IOFunctions.html#ga9e9fc0fac6919241501c228e438fa2b2">CGAL::IO::write_MEDIT</a>(out, tr);</div>
<div class="line">  out.close();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__PkgMesh3Parameters_html_ga9f696ff6caf3c4efd246e43946a89294"><div class="ttname"><a href="../Mesh_3/group__PkgMesh3Parameters.html#ga9f696ff6caf3c4efd246e43946a89294">CGAL::parameters::no_perturb</a></div><div class="ttdeci">unspecified_type no_perturb()</div></div>
<div class="ttc" id="agroup__PkgMesh3Parameters_html_gab24d8652fbb6ae045e989769c5bc69f0"><div class="ttname"><a href="../Mesh_3/group__PkgMesh3Parameters.html#gab24d8652fbb6ae045e989769c5bc69f0">CGAL::parameters::no_exude</a></div><div class="ttdeci">unspecified_type no_exude()</div></div>
</div><!-- fragment --> </details>
<h2><a class="anchor" id="ssecEx4a"></a>
Tetrahedral Remeshing With Sizing Field</h2>
<p>The API enables the user to run tetrahedral remeshing with a custom sizing field, that is used as a sizing criterion to trigger mesh refinement and decimation. The following examples show how to use this type of sizing field.</p>
<p>In the first example, we show how to use the same sizing field as the one used as a meshing criterion for tetrahedral mesh generation using the CGAL <a class="elRef" href="../Manual/packages.html#PkgMesh3">3D Mesh Generation</a> package. <b>Example: </b> <a class="el" href="Tetrahedral_remeshing_2mesh_and_remesh_with_sizing_8cpp-example.html">Tetrahedral_remeshing/mesh_and_remesh_with_sizing.cpp</a> <br>
</p><details>
<summary>
Show / Hide</summary>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/tetrahedral_remeshing.h&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_structRef" href="../STL_Extension/structCGAL_1_1Parallel__if__available__tag.html">CGAL::Parallel_if_available_tag</a> Concurrency_tag;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_structRef" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Domain</span></div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_classRef" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div>
<div class="line"><span class="keyword">typedef</span> K::FT FT;</div>
<div class="line"><span class="keyword">typedef</span> K::Point_3 Point;</div>
<div class="line"><span class="keyword">typedef</span> FT (Function)(<span class="keyword">const</span> Point&amp;);</div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_classRef" href="../Mesh_3/classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> Mesh_domain;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Triangulation</span></div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_classRef" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain, CGAL::Default, Concurrency_tag&gt;::type</a> Tr;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_classRef" href="../SMDS_3/classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a> C3t3;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Criteria</span></div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_classRef" href="../Mesh_3/classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Triangulation for Remeshing</span></div>
<div class="line"><span class="keyword">using </span>T3 = <a class="code hl_classRef" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html">CGAL::Triangulation_3</a>&lt;Tr::Geom_traits,</div>
<div class="line">                                 Tr::Triangulation_data_structure&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>params = <a class="code hl_namespaceRef" href="../STL_Extension/namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Sizing field</span></div>
<div class="line"><span class="keyword">struct </span>Spherical_sizing_field</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">typedef</span> K::FT FT;</div>
<div class="line">  <span class="keyword">typedef</span> K::Point_3 <a class="code hl_classRef" href="../Kernel_23/classCGAL_1_1Point__3.html">Point_3</a>;</div>
<div class="line">  <span class="keyword">typedef</span> Mesh_domain::Index <a class="code hl_classRef" href="../STL_Extension/classIndex.html">Index</a>;</div>
<div class="line"> </div>
<div class="line">  FT operator()(<span class="keyword">const</span> <a class="code hl_classRef" href="../Kernel_23/classCGAL_1_1Point__3.html">Point_3</a>&amp; p, <span class="keyword">const</span> <span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code hl_classRef" href="../STL_Extension/classIndex.html">Index</a>&amp;)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    FT sq_d_to_origin = <a class="code hl_functionRef" href="../Kernel_23/group__squared__distance__grp.html#ga1ff73525660a052564d33fbdd61a4f71">CGAL::squared_distance</a>(p, Point(<a class="code hl_variableRef" href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a>));</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_functionRef" href="../Algebraic_foundations/group__PkgAlgebraicFoundationsRef.html#ga1d5106cf8be16adb4c4dc8b1ec3a5a92">CGAL::abs</a>(<a class="code hl_functionRef" href="../Algebraic_foundations/group__PkgAlgebraicFoundationsRef.html#gab922269072ee9ee99ba8c541418b2e11">CGAL::sqrt</a>(sq_d_to_origin) - 0.5) / 5. + 0.025;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Function</span></div>
<div class="line">FT sphere_function (<span class="keyword">const</span> Point&amp; p)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_functionRef" href="../Kernel_23/group__squared__distance__grp.html#ga1ff73525660a052564d33fbdd61a4f71">CGAL::squared_distance</a>(p, Point(<a class="code hl_variableRef" href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a>)) - 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  Mesh_domain domain = Mesh_domain::create_implicit_mesh_domain</div>
<div class="line">  (sphere_function, K::Sphere_3(<a class="code hl_variableRef" href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a>, K::FT(2))</div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Mesh criteria</span></div>
<div class="line">  Spherical_sizing_field size;</div>
<div class="line">  Mesh_criteria criteria(params::facet_angle(30).facet_size(0.1).facet_distance(0.025).</div>
<div class="line">                         cell_radius_edge_ratio(2).cell_size(size));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Mesh generation</span></div>
<div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria, params::no_exude().<a class="code hl_functionRef" href="../Mesh_3/group__PkgMesh3Parameters.html#ga9f696ff6caf3c4efd246e43946a89294">no_perturb</a>());</div>
<div class="line"> </div>
<div class="line">  T3 tr = <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#gacbc8c23061a2db7654c2ef9209adcfb2">CGAL::convert_to_triangulation_3</a>(std::move(c3t3));</div>
<div class="line">  <span class="comment">//note we use the move semantic, with std::move(c3t3),</span></div>
<div class="line">  <span class="comment">//  to avoid a copy of the triangulation by the function</span></div>
<div class="line">  <span class="comment">//  `CGAL::convert_to_triangulation_3()`</span></div>
<div class="line">  <span class="comment">//  After the call to this function, c3t3 is an empty and valid C3t3.</span></div>
<div class="line">  <span class="comment">//It is possible to use :  CGAL::convert_to_triangulation_3(c3t3),</span></div>
<div class="line">  <span class="comment">//  Then the triangulation is copied and duplicated, and c3t3 remains as is.</span></div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Remeshing..."</span>;</div>
<div class="line">  std::cout.flush();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#ga263775c52eeb483a86a16aeb9eb31af0">CGAL::tetrahedral_isotropic_remeshing</a>(tr, size);</div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"\rRemeshing done."</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="aclassCGAL_1_1Labeled__mesh__domain__3_html"><div class="ttname"><a href="../Mesh_3/classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3</a></div></div>
<div class="ttc" id="aclassCGAL_1_1Point__3_html"><div class="ttname"><a href="../Kernel_23/classCGAL_1_1Point__3.html">CGAL::Point_3</a></div></div>
<div class="ttc" id="aclassIndex_html"><div class="ttname"><a href="../STL_Extension/classIndex.html">Index</a></div></div>
<div class="ttc" id="agroup__PkgAlgebraicFoundationsRef_html_ga1d5106cf8be16adb4c4dc8b1ec3a5a92"><div class="ttname"><a href="../Algebraic_foundations/group__PkgAlgebraicFoundationsRef.html#ga1d5106cf8be16adb4c4dc8b1ec3a5a92">CGAL::abs</a></div><div class="ttdeci">NT abs(const NT &amp;x)</div></div>
<div class="ttc" id="agroup__PkgAlgebraicFoundationsRef_html_gab922269072ee9ee99ba8c541418b2e11"><div class="ttname"><a href="../Algebraic_foundations/group__PkgAlgebraicFoundationsRef.html#gab922269072ee9ee99ba8c541418b2e11">CGAL::sqrt</a></div><div class="ttdeci">NT sqrt(const NT &amp;x)</div></div>
<div class="ttc" id="agroup__kernel__enums_html_ga9d272a8e3a8080b851741b6d3a44afdc"><div class="ttname"><a href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a></div><div class="ttdeci">const CGAL::Origin ORIGIN</div></div>
<div class="ttc" id="agroup__squared__distance__grp_html_ga1ff73525660a052564d33fbdd61a4f71"><div class="ttname"><a href="../Kernel_23/group__squared__distance__grp.html#ga1ff73525660a052564d33fbdd61a4f71">CGAL::squared_distance</a></div><div class="ttdeci">Kernel::FT squared_distance(Type1&lt; Kernel &gt; obj1, Type2&lt; Kernel &gt; obj2)</div></div>
</div><!-- fragment --> </details>
<p>In the second example, we show how to use the provided adaptive sizing field, <code><a class="el" href="classCGAL_1_1Adaptive__remeshing__sizing__field.html">CGAL::Adaptive_remeshing_sizing_field</a></code>, that automatically sets the target edge length to keep a mesh density consistent with the density of the input mesh. <b>Example: </b> <a class="el" href="Tetrahedral_remeshing_2mesh_and_remesh_with_adaptive_sizing_8cpp-example.html">Tetrahedral_remeshing/mesh_and_remesh_with_adaptive_sizing.cpp</a> <br>
</p><details>
<summary>
Show / Hide</summary>
<div class="fragment"><div class="line"><span class="preprocessor">#define CGAL_TETRAHEDRAL_REMESHING_VERBOSE</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedron_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedral_mesh_domain_3.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/tetrahedral_remeshing.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Adaptive_remeshing_sizing_field.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/IO/File_medit.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Domain</span></div>
<div class="line"><span class="keyword">using </span>K = <a class="code hl_classRef" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a>;</div>
<div class="line"><span class="keyword">using </span>Point = K::Point_3;</div>
<div class="line"><span class="keyword">using </span>FT = K::FT;</div>
<div class="line"><span class="keyword">using </span>Polyhedron = CGAL::Polyhedron_3&lt;K&gt;;</div>
<div class="line"><span class="keyword">using </span>Mesh_domain = <a class="code hl_classRef" href="../Mesh_3/classCGAL_1_1Polyhedral__mesh__domain__3.html">CGAL::Polyhedral_mesh_domain_3&lt;Polyhedron, K&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Triangulation for Meshing</span></div>
<div class="line"><span class="keyword">using </span>Tr = <a class="code hl_classRef" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain&gt;::type</a>;</div>
<div class="line"><span class="keyword">using </span>C3t3 = <a class="code hl_classRef" href="../SMDS_3/classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Criteria</span></div>
<div class="line"><span class="keyword">using </span>Mesh_criteria = <a class="code hl_classRef" href="../Mesh_3/classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Triangulation for Remeshing</span></div>
<div class="line"><span class="keyword">using </span>T3 = <a class="code hl_classRef" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html">CGAL::Triangulation_3</a>&lt;Tr::Geom_traits,</div>
<div class="line">                                 Tr::Triangulation_data_structure&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespaceRef" href="../STL_Extension/namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> std::string fname = (argc &gt; 1) ? argv[1] : <a class="code hl_functionRef" href="../Manual/namespaceCGAL.html#acdae9a147ad2a3998cc21f88bc292dac">CGAL::data_file_path</a>(<span class="stringliteral">"meshes/elk.off"</span>);</div>
<div class="line">  std::ifstream input(fname);</div>
<div class="line">  Polyhedron polyhedron;</div>
<div class="line">  input &gt;&gt; polyhedron;</div>
<div class="line">  <span class="keywordflow">if</span> (input.fail()) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt; fname &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_functionRef" href="../BGL/group__PkgBGLHelperFct.html#ga11883d231eec1b58f37efe4acedd9588">CGAL::is_triangle_mesh</a>(polyhedron)) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Input geometry is not triangulated."</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create domain</span></div>
<div class="line">  Mesh_domain domain(polyhedron);</div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Meshing..."</span>;</div>
<div class="line">  std::cout.flush();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Mesh criteria</span></div>
<div class="line">  Mesh_criteria criteria(facet_angle = 25,</div>
<div class="line">                         facet_distance = 0.2,</div>
<div class="line">                         cell_size = 10.,</div>
<div class="line">                         cell_radius_edge_ratio = 3.);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Mesh generation</span></div>
<div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria, <a class="code hl_functionRef" href="../Mesh_3/group__PkgMesh3Parameters.html#ga9f696ff6caf3c4efd246e43946a89294">no_perturb</a>().<a class="code hl_functionRef" href="../Mesh_3/group__PkgMesh3Parameters.html#gab24d8652fbb6ae045e989769c5bc69f0">no_exude</a>());</div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"\rMeshing done."</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  std::ofstream out_mesh(<span class="stringliteral">"out_meshing.mesh"</span>);</div>
<div class="line">  <a class="code hl_functionRef" href="../SMDS_3/group__PkgSMDS3IOFunctions.html#ga9e9fc0fac6919241501c228e438fa2b2">CGAL::IO::write_MEDIT</a>(out_mesh, c3t3.triangulation());</div>
<div class="line">  out_mesh.close();</div>
<div class="line"> </div>
<div class="line">  T3 tr = <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#gacbc8c23061a2db7654c2ef9209adcfb2">CGAL::convert_to_triangulation_3</a>(std::move(c3t3));</div>
<div class="line">  <span class="comment">//note we use the move semantic, with std::move(c3t3),</span></div>
<div class="line">  <span class="comment">//  to avoid a copy of the triangulation by the function</span></div>
<div class="line">  <span class="comment">//  `CGAL::convert_to_triangulation_3()`</span></div>
<div class="line">  <span class="comment">//  After the call to this function, c3t3 is an empty and valid C3t3.</span></div>
<div class="line">  <span class="comment">//It is possible to use :  CGAL::convert_to_triangulation_3(c3t3),</span></div>
<div class="line">  <span class="comment">//  Then the triangulation is copied and duplicated, and c3t3 remains as is.</span></div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Remeshing..."</span>;</div>
<div class="line">  std::cout.flush();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#ga263775c52eeb483a86a16aeb9eb31af0">CGAL::tetrahedral_isotropic_remeshing</a>(tr,</div>
<div class="line">    CGAL::create_adaptive_remeshing_sizing_field(tr),</div>
<div class="line">    CGAL::parameters::number_of_iterations(5));</div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"\rRemeshing done."</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  std::ofstream out(<span class="stringliteral">"out_remeshing.mesh"</span>);</div>
<div class="line">  <a class="code hl_functionRef" href="../SMDS_3/group__PkgSMDS3IOFunctions.html#ga9e9fc0fac6919241501c228e438fa2b2">CGAL::IO::write_MEDIT</a>(out, tr);</div>
<div class="line">  out.close();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="aclassCGAL_1_1Polyhedral__mesh__domain__3_html"><div class="ttname"><a href="../Mesh_3/classCGAL_1_1Polyhedral__mesh__domain__3.html">CGAL::Polyhedral_mesh_domain_3</a></div></div>
</div><!-- fragment --> </details>
<h2><a class="anchor" id="ssecEx5"></a>
Tetrahedral Remeshing from Any Tetrahedral Mesh</h2>
<p>The following example shows how to read a mesh from a triangulation stored in a Medit file, perform tetrahedral remeshing, and save the output triangulation. The input triangulation should follow the validity requirements of a <code><a class="elRef" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html">CGAL::Triangulation_3</a></code> (valid connectivity, positive orientation of the cells, and coverage of the convex hull of the vertices).</p>
<p><b>Example: </b> <a class="el" href="Tetrahedral_remeshing_2tetrahedral_remeshing_from_mesh_8cpp-example.html">Tetrahedral_remeshing/tetrahedral_remeshing_from_mesh.cpp</a> <br>
</p><details>
<summary>
Show / Hide</summary>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Tetrahedral_remeshing/Remeshing_triangulation_3.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/tetrahedral_remeshing.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/IO/File_medit.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_classRef" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_class" href="classCGAL_1_1Tetrahedral__remeshing_1_1Remeshing__triangulation__3.html">CGAL::Tetrahedral_remeshing::Remeshing_triangulation_3&lt;K&gt;</a> Remeshing_triangulation;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* filename = (argc &gt; 1) ? argv[1] : <span class="stringliteral">"data/sphere.mesh"</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> target_edge_length = (argc &gt; 2) ? atof(argv[2]) : 0.1;</div>
<div class="line"> </div>
<div class="line">  Remeshing_triangulation tr;</div>
<div class="line"> </div>
<div class="line">  std::ifstream is(filename, std::ios_base::in);</div>
<div class="line">  <a class="code hl_functionRef" href="../SMDS_3/group__PkgSMDS3IOFunctions.html#gab02697fc5c1e8ebf986fdbf4cf3737fb">CGAL::IO::read_MEDIT</a>(is, tr);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="group__PkgTetrahedralRemeshingRef.html#ga263775c52eeb483a86a16aeb9eb31af0">CGAL::tetrahedral_isotropic_remeshing</a>(tr, target_edge_length);</div>
<div class="line"> </div>
<div class="line">  std::ofstream os(<span class="stringliteral">"after_remeshing.mesh"</span>);</div>
<div class="line">  <a class="code hl_functionRef" href="../SMDS_3/group__PkgSMDS3IOFunctions.html#ga9e9fc0fac6919241501c228e438fa2b2">CGAL::IO::write_MEDIT</a>(os, tr);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__PkgSMDS3IOFunctions_html_gab02697fc5c1e8ebf986fdbf4cf3737fb"><div class="ttname"><a href="../SMDS_3/group__PkgSMDS3IOFunctions.html#gab02697fc5c1e8ebf986fdbf4cf3737fb">CGAL::IO::read_MEDIT</a></div><div class="ttdeci">bool read_MEDIT(std::istream &amp;in, T3 &amp;t3, const NamedParameters &amp;np=parameters::default_values())</div></div>
</div><!-- fragment --> </details>
<h1><a class="anchor" id="secTetRemeshingHistory"></a>
Implementation History</h1>
<p>This package implements the uniform version of the "Multi-Material Adaptive Volume Remesher" algorithm for quality tetrahedral remeshing, described by Noura Faraj et al. in <a class="el" href="citelist.html#CITEREF_faraj2016mvr">[1]</a>.</p>
<p>A first version of the code was written by Noura Faraj, Jean-Marc Thiery, and Tamy Boubekeur. Jane Tournois worked on the finalization of the code, the API, and documentation.</p>
<p>It was initially published in CGAL-5.1.</p>
<p>The ability to use a sizing field as variable target edge length was introduced by Jane Tournois in CGAL-6.0. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.6-->
<!-- start footer part -->
<!-- The footer div is not part of the default but we require it to
move the footer to the bottom of the page. -->
<div id="footer">
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"></a> 1.9.6 </li>
  </ul>
</div>
</div>
</body>


</html>
