<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://doc.cgal.org/latest/Periodic_4_hyperbolic_triangulation_2/index.html"/>

<link rel="icon" type="image/png" href="../Manual/g-196x196-doc.png">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=11">
<meta name="generator" content="Doxygen 1.9.6">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CGAL 6.2 - 2D Periodic Hyperbolic Triangulations: User Manual</title>
<!-- <link href="../Manual/tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="../Manual/jquery.js"></script>
<script type="text/javascript" src="../Manual/dynsections.js"></script>
<script src="../Manual/hacks.js" type="text/javascript"></script>
<!-- Manually include treeview and search to avoid bloat and to fix
     paths to the directory Manual . -->
<!-- $.treeview -->
<!-- $.search -->
<link href="navtree.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="../Manual/resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="../Manual/search/searchdata.js"></script>
<script type="text/javascript" src="../Manual/search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="../Manual/search/search.js"></script>
<!-- Manually done below. -->
<link href="../Manual/doxygen.css" rel="stylesheet" type="text/css">
<link href="../Manual/cgal_stylesheet.css" rel="stylesheet" type="text/css">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
//<![CDATA[
MathJax.Hub.Config(
{
  TeX: {
      Macros: {
          qprel: [ "{\\gtreqless}", 0],
          qpx: [ "{\\mathbf{x}}", 0],
          qpl: [ "{\\mathbf{l}}", 0],
          qpu: [ "{\\mathbf{u}}", 0],
          qpc: [ "{\\mathbf{c}}", 0],
          qpb: [ "{\\mathbf{b}}", 0],
          qpy: [ "{\\mathbf{y}}", 0],
          qpw: [ "{\\mathbf{w}}", 0],
          qplambda: [ "{\\mathbf{\\lambda}}", 0],
          ssWpoint: [ "{\\bf #1}", 1],
          ssWeight: [ "{w_{#1}}", 1],
          dabs: [ "{\\parallel\\! #1 \\!\\parallel}", 1],
          E: [ "{\\mathrm{E}}", 0],
          A: [ "{\\mathrm{A}}", 0],
          R: [ "{\\mathrm{R}}", 0],
          N: [ "{\\mathrm{N}}", 0],
          Q: [ "{\\mathrm{Q}}", 0],
          Z: [ "{\\mathrm{Z}}", 0],
          ccSum: [ "{\\sum_{#1}^{#2}{#3}}", 3],
          ccProd: [ "{\\prod_{#1}^{#2}{#3}}", 3],
          pyr: [ "{\\operatorname{Pyr}}", 0],
          aff: [ "{\\operatorname{aff}}", 0],
          Ac: [ "{\\cal A}", 0],
          Sc: [ "{\\cal S}", 0],
      },
      equationNumbers: { autoNumber: "AMS" }
  }
}
);
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  var PARSE = MathJax.InputJax.TeX.Parse,
      TEXT = PARSE.prototype.InternalText;
  PARSE.Augment({
    InternalText: function (text,def) {
      text = text.replace(/\\/g,"");
      return TEXT.call(this,text,def);
    }
  });
});
//]]>
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<script src="modules.js" type="text/javascript"></script>
<link href="customstyle.css" rel="stylesheet" type="text/css">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="back-nav">
  <ul>
    <li><a href="https://www.cgal.org/">cgal.org</a></li>
    <li><a href="../Manual/index.html">Top</a></li>
    <li><a href="../Manual/general_intro.html">Getting Started</a></li>
    <li><a href="../Manual/tutorials.html">Tutorials</a></li>
    <li><a href="../Manual/packages.html">Package Overview</a></li>
    <li><a href="../Manual/how_to_cite_cgal.html">Acknowledging CGAL</a></li>
  </ul>
  <!-- In a package SEARCHENGINE = false, so we cannot use 
       insertion. That's why we have to do it manually here. Notice
       that we also take pngs from the Manual. -->
  <div id="MSearchBox" class="MSearchBoxInactive">
      <span class="left">
         <span id="MSearchSelect" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"> 
        </span>
        <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)">
      </span>
      <span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../Manual/search/close.svg" alt=""></a>
      </span>
  </div>
</div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CGAL 6.2 - 2D Periodic Hyperbolic Triangulations
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Code below is usually inserted by doxygen when SEARCHENGINE =
     true. Notice that the path to the search directory is adjusted to
     the top-level.-->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../Manual/search/",'.html');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync" style="display: none"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">User Manual </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Chapter_2D_Periodic_Hyperbolic_Triangulations"></a><a class="anchor" id="chapterP4HTriangulation2"></a> </p> <div id="autotoc" class="toc"></div>  <dl class="section author"><dt>Author</dt><dd>Iordan Iordanov and Monique Teillaud</dd></dl>
<center> <img src="new-triangulation-350px.png" alt="" style="max-width:50%; width:50%;" class="inline"> </center><p>This package enables the computation of Delaunay triangulations of the Bolza surface, which is the most symmetric surface of genus 2. The Bolza surface is a hyperbolic closed compact orientable surface. For triangulations on general hyperbolic surfaces, we refer to the package <a class="elRef" href="../Triangulation_on_hyperbolic_surface_2/index.html#Chapter_Hyperbolic_Surface_Triangulations">2D Triangulations on Hyperbolic Surfaces</a>.</p>
<p>A triangulation of the Bolza surface can be seen as a periodic triangulation of the hyperbolic plane.</p>
<h1><a class="anchor" id="P4HT2_thespace"></a>
The Bolza Surface</h1>
<p>Let \(\mathbb{H}^2\) denote the hyperbolic plane, represented in the Poincaré disk model (see Chapter <a class="elRef" href="../Hyperbolic_triangulation_2/index.html#ChapterHTriangulation2">2D Hyperbolic Delaunay Triangulations</a>). The Bolza surface \(\mathcal{M}\) is defined as the quotient of \(\mathbb H^2\) under the action of a group \(\mathcal G\) that we will introduce now.</p>
<p>Consider the regular hyperbolic octagon \( \mathcal D_O \) centered at the origin with all angles equal to \( \pi/4\), as shown in <a class="el" href="index.html#fig__P4HTriangulationOctagonId">Figure 47.1</a>. Note that \(\mathcal D_O\) is unique up to rotation and cannot be scaled since this operation would change its angles. Consider the four hyperbolic translations \( a,b,c,d\) with their respective inverses \(\overline{a},
\overline{b}, \overline{c}, \overline{d}\) that identify the opposite sides of \( \mathcal D_O \). The axes of these translations, shown in <a class="el" href="index.html#fig__P4HTriangulationOctagonId">Figure 47.1</a> - Left, are diameters of the Poincaré disk. The four translations \(a, b, c, d\) generate a (non-commutative) discrete group of orientation-preserving isometries, with finite presentation  </p><p class="formulaDsp">
\[ \mathcal{G} = \left&lt; a,b,c,d \; \bigg| \;
    abcd\overline{a}\overline{b}\overline{c}\overline{d} \right&gt;. \]
</p>
<p> Note that equivalent translations of the group \(\mathcal G\) can be reduced to a unique minimal representative.</p>
<p>The group \(\mathcal G\) is acting on \(\mathbb H^2\): two points \(p\) and \(q\) in \(\mathbb H^2\) are in the same orbit under the action of \(\mathcal G\) if there exists an element \(g \in \mathcal G\) such that \(g(p) = q\), as shown in <a class="el" href="index.html#fig__P4HTriangulationOctagonId">Figure 47.1</a> - Center. The Bolza surface \(\mathcal{M}\) is defined as the quotient of \(\mathbb H^2\) under the action of \(\mathcal G\), named the fundamental group of \(\mathcal M\): </p><p class="formulaDsp">
\[ \mathcal{M} = \mathbb H^2 / \mathcal{G}. \]
</p>
<p> The natural projection map from \(\mathbb H^2\) onto \(\mathcal M\) is denoted with \(\pi\). By definition, all points of \(\mathbb H^2\) that belong to the same orbit under the action of \(\mathcal G\) project by \(\pi\) onto the same point of the surface \(\mathcal M\).</p>
<p><a class="anchor" id="fig__P4HTriangulationOctagonId"></a></p><center> <img src="octagon_identification.svg" alt="" style="pointer-events: none; max-width:25%; width:25%; display: inline-block;" class="inline"> <img src="periodicity.png" alt="" style="max-width:25%; width:25%; display: inline-block;" class="inline"> <img src="original_domain.svg" alt="" style="pointer-events: none; max-width:25%; width:25%; display: inline-block;" class="inline"> </center>  <div class="cgal_figure_caption"> <p> <a class="el" href="index.html#fig__P4HTriangulationOctagonId">Figure 47.1</a> <b>Left:</b> The hyperbolic translations \(a,b,c,d\) and their inverses identify opposite sides of the octagon \(\mathcal D_O\). <b>Center:</b> Illustration of periodicity in the hyperbolic plane. The figure shows a few periodic copies of the points in the central octagon. <b>Right:</b> The half-open octagon \(\mathcal D\) is an original domain for \(\mathcal{M}\). Note that only one vertex of the octagon is contained in the original domain. </p> </div> <p> <br>
</p>
<p>The half-open octagon \(\mathcal D\) shown in <a class="el" href="index.html#fig__P4HTriangulationOctagonId">Figure 47.1</a> - Right contains exactly one <em>representative</em> of each point of \(\mathcal{M}\); \(\mathcal D\) is called the <em>original domain</em> of \(\mathcal{M}\). A point outside \(\mathcal D\) is the image of a point in \(\mathcal D\), its representative, under the action of a uniquely defined translation in the group \(\mathcal{G}\).</p>
<p><a class="el" href="index.html#fig__P4HTDoubleTorusConstruction">Figure 47.2</a> illustrates how a genus-2 surface can be obtained by identifying opposite sides of \(\mathcal
D\) under the action of \(\mathcal G\).</p>
<p><a class="anchor" id="fig__P4HTDoubleTorusConstruction"></a></p><center> <img src="dt-construction.svg" alt="" style="pointer-events: none; max-width:60%; width:60%; display: inline-block;" class="inline"> </center>  <div class="cgal_figure_caption"> <p> <a class="el" href="index.html#fig__P4HTDoubleTorusConstruction">Figure 47.2</a> Topological construction of a genus-2 surface from the original domain \(\mathcal D\) of the Bolza surface. Each open side is paired with the opposite closed side. Note that all vertices of the octagon project to the same point on the surface, which is represented uniquely by the only vertex of \(\mathcal D\). </p> </div> <p> <br>
</p>
<h1><a class="anchor" id="P4HT2_representation"></a>
Representation</h1>
<p>In the following, and when there is no risk of confusion, the same notation will be used for a point on the surface \(\mathcal M\) and its representative in \(\mathcal
D\). Similarly, \(\mathcal{P}\) will denote both a set of points on the surface and the set of their representatives in \(\mathcal D\).</p>
<p>We require that all input points lie inside \(\mathcal D\).</p>
<h2><a class="anchor" id="P4HT2_Data_structure"></a>
Data Structure</h2>
<p>The Delaunay triangulation of \(\mathcal{M}\) defined by a point set \(\mathcal{P}\) is the projection by \(\pi\) of the Delaunay triangulation in the plane \(\mathbb H^2\) of the (infinite) set of points \(\mathcal{G P}\) onto \(\mathcal{M}\), provided that some <em>condition</em> (detailed in Section <a class="el" href="index.html#P4HT2_Embedding_condition">Simplicial Embedding Condition</a> below) holds. More details can be found in <a class="el" href="citelist.html#CITEREF_cgal:btv-dtosl-16">[1]</a>.</p>
<p>As for orbits of points, all faces of the Delaunay triangulation of \(\mathcal{G P}\) that are in the same orbit under the action of \(\mathcal{G}\) project by \(\pi\) onto the same face on the surface \(\mathcal{M}\). We can define a unique <em>canonical</em> representative for each orbit, which has at least one vertex in \(\mathcal D\). Some canonical faces have vertices both inside and outside \(\mathcal D\); such faces can be uniquely specified by three pairs of points in \(\mathcal D\) and reduced translations of \(\mathcal{G}\) (points in the original domain are paired with the identity translation \(\mathbb 1)\). The underlying combinatorial triangulation is a <a class="elRef" href="../Manual/packages.html#PkgTDS2">2D Triangulation Data Structure</a> enriched in each face by the three translations that are paired with the point in each vertex of the canonical representative (see <a class="el" href="index.html#fig__P4HTriangulationOrientationDS">Figure 47.3</a>).</p>
<p><a class="anchor" id="fig__P4HTriangulationOrientationDS"></a></p><center> <img src="ds_cgal.svg" alt="" style="pointer-events: none; max-width:40%; width: 1000px;" class="inline"> </center>  <div class="cgal_figure_caption"> <p> <a class="el" href="index.html#fig__P4HTriangulationOrientationDS">Figure 47.3</a> Representation of a face \(f\) stored in the triangulation data structure. Each vertex \(v_i\) stores a point \(p_i\) paired with a translation \(\tau_i\). </p> </div> <p> <br>
</p>
<p>More precisely, the translations are elements of the subset \(\mathcal N\) of \(\mathcal G\) for which the image of \(\mathcal D_O\) has at least one vertex in common with \(\mathcal D_O\). These images of \(\mathcal D_O\) by translations in \(\mathcal N\) are shaded in <a class="el" href="index.html#fig__P4HTriangulationCanonicalRepExample">Figure 47.4</a>; we consider them to be ordered counterclockwise around \(\mathcal D_O\), arbitrarily starting with the one corresponding to translation \(abcd\). The canonical representative in \(\mathbb H^2\) of a face on \(\mathcal M\) is such that </p><ul>
<li>
either all vertices of the representative lie in \(\mathcal D\), or </li>
<li>
at least one of the vertices of the representative lies in \(\mathcal D\) and is as close as possible to \(abcd\) in the ordering defined above. </li>
</ul>
<p><a class="anchor" id="fig__P4HTriangulationCanonicalRepExample"></a></p><center> <img src="periodic_face.svg" alt="" style="pointer-events: none; max-width:45%; width:45%; display: inline-block;" class="inline"> </center>  <div class="cgal_figure_caption"> <p> <a class="el" href="index.html#fig__P4HTriangulationCanonicalRepExample">Figure 47.4</a> Among the three faces in the orbit that have at least one vertex in \(\mathcal D\), the canonical representative is the green one: it is closest, in the counterclockwise order, to the region labeled \(abcd\). The translations \(\mathbb 1, a,\) and \(\overline{b}\), corresponding to the points \(p, q\), and \(r\) are stored in the face in the data structure. </p> </div> <p> <br>
</p>
<h2><a class="anchor" id="P4HT2_Embedding_condition"></a>
Simplicial Embedding Condition</h2>
<p>Let us now give details on the <em>condition</em> mentioned above. The projection by \(\pi\) of the Delaunay triangulation in \(\mathbb H^2\) of \(\mathcal{G P}\) is a <em>triangulation</em> of \(\mathcal{M}\) if and only if its combinatorial graph does not contain loops (i.e., edges having two identical vertices) or double edges (i.e., two edges sharing the same two vertices), or, equivalently, if the projection is a simplicial complex: </p><ul>
<li>
any face of a simplex is a simplex, and </li>
<li>
two simplices either do not intersect or share one common face.  </li>
</ul>
<p>Some point sets do not define a triangulation of \(\mathcal M\). For instance, a single point does not define a triangulation of \(\mathcal M\), as all edges of the induced subdivision would be loops. Another example is shown in <a class="el" href="index.html#fig__P4HNonSimplicialExample">Figure 47.5</a>.</p>
<p><a class="anchor" id="fig__P4HNonSimplicialExample"></a></p><center> <img src="non-triangulation.svg" alt="" style="pointer-events: none; max-width:33%; width:33%; display: inline-block;" class="inline"> </center>  <div class="cgal_figure_caption"> <p> <a class="el" href="index.html#fig__P4HNonSimplicialExample">Figure 47.5</a> The three points in the central octagon define a non-simplicial subdivision of the Bolza surface. The pink edge between the two blue vertices corresponds to a loop on the surface. The two blue edges correspond to a double edge on the surface; the two green edges, too. </p> </div> <p> <br>
</p>
<p>We initialize a triangulation of \(\mathcal M\) with a predetermined set \(\mathcal Q\) of 14 points, called <em>dummy points</em> (see <a class="el" href="index.html#fig__P4HTriangulationDummyPoints">Figure 47.6</a>), which ensures that the projection by \(\pi\) of the Delaunay triangulation of \(\mathcal{G}
(\mathcal{P}\cup\mathcal{Q})\) onto \(\mathcal M\) is a simplicial complex for any set of input points \(\mathcal{P}\) <a class="el" href="citelist.html#CITEREF_cgal:btv-dtosl-16">[1]</a>.</p>
<p><a class="anchor" id="fig__P4HTriangulationDummyPoints"></a></p><center> <img src="dummy-points.png" alt="" style="max-width:35%; width:35%; display: inline-block;" class="inline"> </center>  <div class="cgal_figure_caption"> <p> <a class="el" href="index.html#fig__P4HTriangulationDummyPoints">Figure 47.6</a> Delaunay triangulation of \(\mathcal M\) defined by the 14 dummy points. The set \(\mathcal Q\) of dummy points contains the origin, the vertex of \(\mathcal D\), the midpoints of the closed sides of \(\mathcal D\), and the (hyperbolic) midpoints of the segments between the origin and the vertices of the octagon. </p> </div> <p> <br>
</p>
<p>If sufficiently many well-distributed points are inserted, the dummy points become unnecessary, i.e., the subdivision remains a simplicial complex even if we remove them. Otherwise some dummy points are left to ensure that the final subdivision is a simplicial complex.</p>
<h1><a class="anchor" id="P4HT2_design"></a>
Software Design</h1>
<p>The main class of this package is <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2.html" title="The class Periodic_4_hyperbolic_Delaunay_triangulation_2 enables the construction and handling of Del...">Periodic_4_hyperbolic_Delaunay_triangulation_2</a></code>, which implements Delaunay triangulations of the Bolza surface \(\mathcal M\). The prefix "Periodic_4" emphasizes that the triangulation in the universal covering \(\mathbb H^2\) is periodic in the four directions defined by the hyperbolic translations \( a,b,c\), and \(d\).</p>
<p>The implementation is fully dynamic, supporting both point insertion and vertex removal. However, a vertex can be removed only if the subdivision remains a simplicial complex.</p>
<p>The class <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2.html" title="The class Periodic_4_hyperbolic_Delaunay_triangulation_2 enables the construction and handling of Del...">Periodic_4_hyperbolic_Delaunay_triangulation_2</a></code> provides high-level geometric functionality specific to Delaunay triangulations, such as point insertion and vertex removal, the side-of-circle test, finding the conflicting region of a given point, and dual functions. It inherits from a base class, <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__triangulation__2.html" title="The class Periodic_4_hyperbolic_triangulation_2 offers base functionalities needed by Periodic_4_hype...">Periodic_4_hyperbolic_triangulation_2</a></code>, which provides functionality common to triangulations in general, such as point location <a class="el" href="citelist.html#CITEREF_cgal:dpt-wt-02">[2]</a>, and access functions, but supports neither point insertion nor vertex removal.</p>
<p>Both classes <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__triangulation__2.html" title="The class Periodic_4_hyperbolic_triangulation_2 offers base functionalities needed by Periodic_4_hype...">Periodic_4_hyperbolic_triangulation_2</a></code> and <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2.html" title="The class Periodic_4_hyperbolic_Delaunay_triangulation_2 enables the construction and handling of Del...">Periodic_4_hyperbolic_Delaunay_triangulation_2</a></code> have two template parameters that reflect the separation between the geometric and combinatorial structures of the triangulation:</p>
<ul>
<li>a <b>geometric traits</b> class, which provides all objects, predicates, and constructions that are necessary for the computation of Delaunay triangulations of the Bolza surface (see Section <a class="el" href="index.html#P4HT2_traits">The Geometric Traits Parameter</a>).</li>
<li>a <b>triangulation data structure</b> class, which encodes the combinatorial structure of the triangulation (see Section <a class="el" href="index.html#P4HT2_datastructure">The Triangulation Data Structure Parameter</a>).</li>
</ul>
<h2><a class="anchor" id="P4HT2_traits"></a>
The Geometric Traits Parameter</h2>
<p>The geometric traits class must fulfill the requirements described in the concept <code><a class="el" href="classPeriodic__4HyperbolicDelaunayTriangulationTraits__2.html">Periodic_4HyperbolicDelaunayTriangulationTraits_2</a></code>. Moreover, the traits class must represent hyperbolic translations of the group \(\mathcal G\) via the class <code><a class="el" href="classCGAL_1_1Hyperbolic__octagon__translation.html" title="The class Hyperbolic_octagon_translation defines an object to represent a hyperbolic translation of t...">Hyperbolic_octagon_translation</a></code>.</p>
<p>A model for the concept <code><a class="el" href="classPeriodic__4HyperbolicDelaunayTriangulationTraits__2.html">Periodic_4HyperbolicDelaunayTriangulationTraits_2</a></code> offered by this package is the class <code><a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__traits__2.html" title="The class Periodic_4_hyperbolic_Delaunay_triangulation_traits_2 is the default traits class for the c...">Periodic_4_hyperbolic_Delaunay_triangulation_traits_2</a></code>. The class has one template parameter: </p><ul>
<li>
A <code><a class="elRef" href="../Kernel_23/classKernel.html">Kernel</a></code> with a field number type <code>FT</code> that guarantees exact computations on algebraic numbers with nested square roots. The default value for this parameter is <code><a class="elRef" href="../Kernel_23/classCGAL_1_1Exact__predicates__exact__constructions__kernel__with__sqrt.html">CGAL::Exact_predicates_exact_constructions_kernel_with_sqrt</a></code>. </li>
</ul>
<h2><a class="anchor" id="P4HT2_datastructure"></a>
The Triangulation Data Structure Parameter</h2>
<p>The triangulation data structure is a container for the faces and vertices and maintains incidence and adjacency relations. This parameter must meet the requirements described in the concept <code><a class="elRef" href="../TDS_2/classTriangulationDataStructure__2.html">TriangulationDataStructure_2</a></code>, for which CGAL offers the model <code><a class="elRef" href="../TDS_2/classCGAL_1_1Triangulation__data__structure__2.html">Triangulation_data_structure_2</a></code>. To represent periodic hyperbolic triangulations, the face and vertex of the triangulation data structure must be models of the concepts <code><a class="el" href="classPeriodic__4HyperbolicTriangulationFaceBase__2.html">Periodic_4HyperbolicTriangulationFaceBase_2</a></code> and <code><a class="el" href="classPeriodic__4HyperbolicTriangulationVertexBase__2.html">Periodic_4HyperbolicTriangulationVertexBase_2</a></code>, respectively. The model <code><a class="elRef" href="../TDS_2/classCGAL_1_1Triangulation__data__structure__2.html">CGAL::Triangulation_data_structure_2</a></code> is parameterized by a vertex base class and a face base class, which gives the possibility to customize the vertices and faces used by the triangulation data structure.</p>
<p>The default value for the triangulation data structure parameter is <code><a class="elRef" href="../TDS_2/classCGAL_1_1Triangulation__data__structure__2.html">Triangulation_data_structure_2</a>&lt; <a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__triangulation__vertex__base__2.html" title="The class Periodic_4_hyperbolic_triangulation_vertex_base_2 is the default model for the concept Peri...">Periodic_4_hyperbolic_triangulation_vertex_base_2</a>&lt;Traits&gt;, <a class="el" href="classCGAL_1_1Periodic__4__hyperbolic__triangulation__face__base__2.html" title="The class Periodic_4_hyperbolic_triangulation_face_base_2 is the default model for the concept Period...">Periodic_4_hyperbolic_triangulation_face_base_2</a>&lt;Traits&gt; &gt;</code>, where <code>Traits</code> is a model of <code><a class="el" href="classPeriodic__4HyperbolicDelaunayTriangulationTraits__2.html">Periodic_4HyperbolicDelaunayTriangulationTraits_2</a></code>.</p>
<h1><a class="anchor" id="P4HT2_examples"></a>
Example</h1>
<p>Most functionalities of periodic hyperbolic triangulations are similar to those of Euclidean 2D triangulations. We refer the reader to the following two examples of the <a class="elRef" href="../Triangulation_2/index.html#Chapter_2D_Triangulations">2D Triangulation</a> package: </p><ul>
<li>
<a class="elRef" href="../Triangulation_2/index.html#Subsection_2D_Triangulations_Voronoi">Voronoi Diagram</a> </li>
<li>
<a class="elRef" href="../Triangulation_2/index.html#Triangulation_2AddingColors">Adding Colors</a> </li>
</ul>
<p>The example below shows the initialization of a periodic hyperbolic 2D Delaunay triangulation, the insertion of random points uniformly distributed in the unit disk for the Euclidean metric, and the properties of the triangulation after the insertion. It uses the default triangulation data structure.</p>
<p><br>
<b>File</b> <a class="el" href="Periodic_4_hyperbolic_triangulation_2_2p4ht2_example_insertion_8cpp-example.html">Periodic_4_hyperbolic_triangulation_2/p4ht2_example_insertion.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Hyperbolic_octagon_translation.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_4_hyperbolic_Delaunay_triangulation_2.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_4_hyperbolic_Delaunay_triangulation_traits_2.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;CGAL/point_generators_2.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_class" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__traits__2.html">CGAL::Periodic_4_hyperbolic_Delaunay_triangulation_traits_2&lt;&gt;</a>           Traits;</div>
<div class="line"><span class="keyword">typedef</span> Traits::FT                                                              NT;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_class" href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2.html">CGAL::Periodic_4_hyperbolic_Delaunay_triangulation_2&lt;Traits&gt;</a>            Triangulation;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_typedefRef" href="../Triangulation/classCGAL_1_1Triangulation.html#a9cce545266f97305c03009e19a9574b8">Triangulation::Vertex_handle</a>                                            Vertex_handle;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_typedefRef" href="../Triangulation/classCGAL_1_1Triangulation.html#a1b422d984178df24b1802d9ea89a3731">Triangulation::Point</a>                                                    Point;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_typedefRef" href="../Triangulation/classCGAL_1_1Triangulation.html#ae83c49f5f2f90371376ee0faf469e760">Triangulation::size_type</a>                                                size_type;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code hl_classRef" href="../STL_Extension/classCGAL_1_1Creator__uniform__2.html">CGAL::Creator_uniform_2&lt;NT,Point&gt;</a>                                       Creator;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> N;</div>
<div class="line">  <span class="keywordflow">if</span>(argc &lt; 2) {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">"usage: "</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">" [number_of_points_to_insert]"</span> &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">"Defaulting to 100k points..."</span> &lt;&lt; std::endl;</div>
<div class="line">    N = 100000;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    N = atoi(argv[1]);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> N1 = N/2;</div>
<div class="line">  <span class="keywordtype">int</span> N2 = N - N1;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Generate N random points uniformly distributed with respect to the Euclidean</span></div>
<div class="line">  <span class="comment">// metric in the disk with radius 0.85, which contains the fundamental domain.</span></div>
<div class="line">  <span class="comment">// Some of the points will be outside the octagon, so they will not be inserted.</span></div>
<div class="line">  std::vector&lt;Point&gt; pts;</div>
<div class="line">  CGAL::Random_points_in_disc_2&lt;Point,Creator&gt; g(0.85);</div>
<div class="line">  std::copy_n(g, N1, std::back_inserter(pts));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// The triangulation is automatically initialized with the dummy points.</span></div>
<div class="line">  Triangulation tr;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Batch-insert new points in the triangulation. Note that by default, after</span></div>
<div class="line">  <span class="comment">// the insertion of a set of points, an attempt is made to remove all dummy points</span></div>
<div class="line">  <span class="comment">// from the triangulation. Note the third boolean parameter in the call of the</span></div>
<div class="line">  <span class="comment">// `insert()` function which suppresses the automatic removal of dummy points.</span></div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Batch-inserting "</span> &lt;&lt; N1 &lt;&lt; <span class="stringliteral">" random points in the triangulation... "</span>; std::cout.flush();</div>
<div class="line">  size_type N_batch_inserted = tr.insert(pts.begin(), pts.end(), <span class="keyword">false</span>);</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"DONE! "</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Insert new points in the triangulation one by one. When points are inserted</span></div>
<div class="line">  <span class="comment">// one by one, dummy points are not automatically removed.</span></div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Single-inserting "</span> &lt;&lt; N2 &lt;&lt; <span class="stringliteral">" random points in the triangulation... "</span>; std::cout.flush();</div>
<div class="line">  <span class="keywordtype">int</span> N_single_inserted = 0;</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;N2; ++i)</div>
<div class="line">  {</div>
<div class="line">    Vertex_handle vh = tr.insert(*(++g));</div>
<div class="line">    <span class="keywordflow">if</span>(vh != Vertex_handle())</div>
<div class="line">      N_single_inserted++;</div>
<div class="line">  }</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"DONE! "</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Total number of inserted points.</span></div>
<div class="line">  std::size_t N_inserted = N_batch_inserted + N_single_inserted;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Finally, we try to manually remove all dummy points from the triangulation.</span></div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Cleaning dummy points from the triangulation... "</span>; std::cout.flush();</div>
<div class="line">  tr.try_to_remove_dummy_vertices();</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"DONE! "</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Make sure that the triangulation is valid.</span></div>
<div class="line">  assert(tr.is_valid());</div>
<div class="line"> </div>
<div class="line">  std::size_t NV = tr.number_of_vertices();</div>
<div class="line">  std::size_t NF = tr.number_of_faces();</div>
<div class="line">  std::size_t NE = tr.number_of_edges();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// This function `tr.number_of_dummy_points()` returns the number of dummy points that</span></div>
<div class="line">  <span class="comment">// are currently in the triangulation.</span></div>
<div class="line">  <span class="keywordtype">int</span> NDP = tr.number_of_dummy_points();</div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"-------------- STATS --------------"</span> &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Random points generated:           "</span> &lt;&lt; N &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Vertices in the triangulation:     "</span> &lt;&lt; NV &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Dummy points in the triangulation: "</span> &lt;&lt; NDP &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Random points inserted:            "</span> &lt;&lt; N_inserted &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Random points outside/duplicates:  "</span> &lt;&lt; (N - N_inserted) &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"---------- COMBINATORICS ----------"</span> &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of vertices NV:             "</span> &lt;&lt; NV &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of faces NF:                "</span> &lt;&lt; NF &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of edges NE:                "</span> &lt;&lt; NE &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// The number of vertices in the triangulation must equal the number of points</span></div>
<div class="line">  <span class="comment">// inserted, plus the dummy points in the triangulation.</span></div>
<div class="line">  assert(N_inserted + NDP == NV);</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of vertices is correct!     "</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Note that the Euler relation is already verified by the function `is_valid()`.</span></div>
<div class="line">  assert((2 + NE - NV - NF) / 2 == 2);</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Euler relation verified!           "</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="aclassCGAL_1_1Creator__uniform__2_html"><div class="ttname"><a href="../STL_Extension/classCGAL_1_1Creator__uniform__2.html">CGAL::Creator_uniform_2</a></div></div>
<div class="ttc" id="aclassCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2_html"><div class="ttname"><a href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__2.html">CGAL::Periodic_4_hyperbolic_Delaunay_triangulation_2</a></div><div class="ttdoc">The class Periodic_4_hyperbolic_Delaunay_triangulation_2 enables the construction and handling of Del...</div><div class="ttdef"><b>Definition:</b> Periodic_4_hyperbolic_Delaunay_triangulation_2.h:31</div></div>
<div class="ttc" id="aclassCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__traits__2_html"><div class="ttname"><a href="classCGAL_1_1Periodic__4__hyperbolic__Delaunay__triangulation__traits__2.html">CGAL::Periodic_4_hyperbolic_Delaunay_triangulation_traits_2</a></div><div class="ttdoc">The class Periodic_4_hyperbolic_Delaunay_triangulation_traits_2 is the default traits class for the c...</div><div class="ttdef"><b>Definition:</b> Periodic_4_hyperbolic_Delaunay_triangulation_traits_2.h:20</div></div>
<div class="ttc" id="aclassCGAL_1_1Triangulation_html_a1b422d984178df24b1802d9ea89a3731"><div class="ttname"><a href="../Triangulation/classCGAL_1_1Triangulation.html#a1b422d984178df24b1802d9ea89a3731">CGAL::Triangulation::Point</a></div><div class="ttdeci">TriangulationTraits_::Point_d Point</div></div>
<div class="ttc" id="aclassCGAL_1_1Triangulation_html_a9cce545266f97305c03009e19a9574b8"><div class="ttname"><a href="../Triangulation/classCGAL_1_1Triangulation.html#a9cce545266f97305c03009e19a9574b8">CGAL::Triangulation::Vertex_handle</a></div><div class="ttdeci">TriangulationDataStructure_::Vertex_handle Vertex_handle</div></div>
<div class="ttc" id="aclassCGAL_1_1Triangulation_html_ae83c49f5f2f90371376ee0faf469e760"><div class="ttname"><a href="../Triangulation/classCGAL_1_1Triangulation.html#ae83c49f5f2f90371376ee0faf469e760">CGAL::Triangulation::size_type</a></div><div class="ttdeci">TriangulationDataStructure_::size_type size_type</div></div>
</div><!-- fragment --><h1><a class="anchor" id="P4HT2_Performance"></a>
Performance</h1>
<p>We have measured the insertion execution time of our implementation against other CGAL triangulations. Random points, uniformly distributed in the unit disk with respect to the Euclidean metric, are generated. From these generated points, we select 1 million points that lie in the original octagon \(\mathcal D_O\). We insert the same set of points in three triangulations: </p><ul>
<li>
a periodic hyperbolic Delaunay triangulation with <code><a class="elRef" href="../Number_types/classCORE_1_1Expr.html">CORE::Expr</a></code> as <code>number type</code>; </li>
<li>
a (non-periodic) Euclidean Delaunay triangulation with <code><a class="elRef" href="../Number_types/classCORE_1_1Expr.html">CORE::Expr</a></code> as <code>number type</code>; </li>
<li>
a (non-periodic) Euclidean Delaunay triangulation with <code>double</code> as <code>number type</code>. </li>
</ul>
<p>We report results averaged over 10 executions of this experiment in <a class="el" href="index.html#Table_1">Table 1</a> below. The experiments have been executed on two machines: </p><ul>
<li>
<b>Machine 1:</b> MacBook Pro (2015), CPU: Intel Core i5 @ 2.9 GHz, RAM: 16 GB @ 1867 MHz, OS: Mac OS X (10.10.5), Compiler: clang-700.1.81; </li>
<li>
<b>Machine 2:</b> Dell Vostro 5471 (2018), CPU: Intel Core i5 @ 1.6 GHZ (up to 3.4 GHz in TurboMode), RAM: 8GB @ 2400 MHz, OS: Linux Mint 19 (kernel 4.15.0), Compiler: gcc version 7.3.0. </li>
</ul>
<center> <a class="anchor" id="Table_1"></a><table class="doxtable">
<caption>Table 1: Comparison of insertion times of 1 million random points</caption>
<tr>
<th>Triangulation type </th><th>Machine 1 </th><th>Machine 2 </th></tr>
<tr>
<td>Periodic hyperbolic (<code><a class="elRef" href="../Number_types/classCORE_1_1Expr.html">CORE::Expr</a></code>) <div style="width:100px; max-width:100px; display:inline-block;"></div> </td><td>55 sec. </td><td>40 sec. </td></tr>
<tr>
<td>Non-periodic Euclidean (<code><a class="elRef" href="../Number_types/classCORE_1_1Expr.html">CORE::Expr</a></code>) </td><td>24 sec. </td><td>20 sec. </td></tr>
<tr>
<td>Non-periodic Euclidean (<code>double</code>) </td><td>1 sec. </td><td>1 sec. </td></tr>
</table>
</center><p>Another experiment shows that, on average, all dummy points are removed from the triangulation with the insertion of fewer than 200 random points uniformly distributed in the unit disk with respect to the Euclidean metric. We start with an empty triangulation of the Bolza surface (i.e., initialized with only the dummy points), and we insert random points one by one. After each insertion, the unnecessary dummy points (if any) are removed from the triangulation. As soon as the last dummy point has been removed, we stop the process and record the number of random points inserted. Results are shown in <a class="el" href="index.html#fig__P4HDummyPointsHistogram">Figure 47.7</a>.</p>
<p><a class="anchor" id="fig__P4HDummyPointsHistogram"></a></p><center> <img src="histogram-dummy-points.png" alt="" style="max-width:85%; width:85%; display: inline-block;" class="inline"> </center>  <div class="cgal_figure_caption"> <p> <a class="el" href="index.html#fig__P4HDummyPointsHistogram">Figure 47.7</a> Histogram of the number of random input points needed to remove all dummy points in a triangulation of the Bolza surface. The histogram shows results acquired from 1000 executions of the experiment described above. In these 1000 executions, the minimum number of random points needed to remove all dummy points was 23, the maximum 188, and on average 64 random points were needed. </p> </div> <p> <br>
</p>
<h1><a class="anchor" id="P4HT2_Design"></a>
Design and Implementation History</h1>
<p>This package implements the algorithm for the computation of Delaunay triangulation of the Bolza surface proposed by Mikhail Bogdanov, Monique Teillaud, and Gert Vegter <a class="el" href="citelist.html#CITEREF_cgal:btv-dtosl-16">[1]</a>. The implementation itself is described by Iordan Iordanov and Monique Teillaud <a class="el" href="citelist.html#CITEREF_cgal:it-idtbs-17">[3]</a>.</p>
<p>In 2016, Iordanov started working on the 2D Periodic Hyperbolic Triangulations package.</p>
<p>The authors would like to thank their partners from the <a href="https://members.loria.fr/Monique.Teillaud/collab/Astonishing/">Astonishing</a> and <a href="https://members.loria.fr/Monique.Teillaud/collab/SoS/">SoS</a> projects for very helpful discussions. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.6-->
<!-- start footer part -->
<!-- The footer div is not part of the default but we require it to
move the footer to the bottom of the page. -->
<div id="footer">
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"></a> 1.9.6 </li>
  </ul>
</div>
</div>
</body>


</html>
